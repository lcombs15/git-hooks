language: python
python:
  - "3.7"
install:
  - pip install -r requirements.txt
script:
  # Lint step 1
  - pylint src/main/
  # Lint step 2 (Disable docstring requirements)
  - pylint --disable=C0111 src/test
  # Run all tests
  - pytest
  # Package
  - pyinstaller --onefile src/main/commit_msg_hook.py --name commit_msg.exe
after_success:
  - wget https://raw.githubusercontent.com/DiscordHooks/travis-ci-discord-webhook/master/send.sh
  - chmod +x send.sh
  - ./send.sh success $WEBHOOK_URL
after_failure:
  - wget https://raw.githubusercontent.com/DiscordHooks/travis-ci-discord-webhook/master/send.sh
  - chmod +x send.sh
  - ./send.sh failure $WEBHOOK_URL
